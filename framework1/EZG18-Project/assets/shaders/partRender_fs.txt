#version 440 core                                                            
                                                               
layout (location = 0) out vec4 FragColor; 

in vec3 FragPos;

uniform vec3 lightDir;
uniform vec3 lightPos;
uniform float cutOff;
uniform float iC;
uniform float lightPower;
                                                                                    
void main()                                                                         
{        

	vec3 lightDirTF = normalize(lightPos - FragPos);    
    	            
    float theta = dot(lightDirTF, normalize(-lightDir)); 
    float epsilon = iC-cutOff;
    float intensity = clamp((theta-cutOff)/epsilon , 0.0, 1.0);

	float distance = length(lightPos - FragPos);
	if (distance < 2.0) intensity = 0.0f;

	intensity *= 1.0 / (1.0f + 0.02f * distance + 0.0025f * (distance * distance));
	
    FragColor = vec4(0.9, 0.8, 0.7, (0.25f + (intensity * 0.75f)) * lightPower); 
}